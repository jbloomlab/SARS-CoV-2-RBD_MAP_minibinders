This folder contains manually assembled input data for the Vir antibody set. This will eventually need to be worked into the pipeline once we split the Vir repo off from the main MAP repo.

Files:
 - `RBD_site_annotations.csv` contains site-level metrics that we may want to illustrate in heatmap overlays on logoplots. This file was generated in the script `../../custom_analyses/custom-plots_vir.Rmd`. Metrics are:
   - `sarbecovirus_Neff` gives the effective number of amino acids in the sarbecovirus RBD alignment
   - `GISAID_201225_total_freq` gives the total frequency of sequences on GISAID as of 25 Dec 2020 containing any amino acid variant at the site
   - `GISAID_201225_number_amino_acids` gives the total number of unique amino acid variants observed among GISAID sequences as of 25 Dec 2020
 - `antibody_annotations.csv` contains antibody-level metrics that we may want to color onto MDS plots or otherwise use to illustrate the relationships among antibody properties. This file includes manually assembled values in the file `antibody_annotations_input.csv`, with remaining metrics added in the script `../../custom_analyses/custom-plots_vir.Rmd`. Metrics include:
   - `MLV_IC50`: antibody neut potency for spike-pseudotyped MLV particles, measured by Vir. Set current as of 28 Dec 2020
   - `VSV_IC50`: antibody neut potency for spike-pseudotyped VSV particles, measured by Vir. Set current as of 28 Dec 2020
   - `FFU_IC50`: antibody neut potency for authentic SARS-CoV-2 virus, measured in focus forming units by Vir. Set current as of 28 Dec 2020
   - `IF_luc_IC50`: antibody neut potency for authentic SARS-CoV-2 virus, measured via immunofluorescence by Vir. Set current as of 28 Dec 2020
   - `RBD_SPR_nM` is KD for antibody Fab binding to SARS-CoV-2 RBD, measured via SPR by Vir. Set current as of 28 Dec 2020.
   - `breadth` is my metric of breadth from our sarbecovirus homolog profiling assays. I calculated breadth within each of the four clades separately and took the average across the four, to evenly weight binding within each clade despite uneven number of sarbecovirus representatives. As an example, an antibody that binds 4 of 4 SARS-CoV-2 clade, 8 of 8 SARS-CoV-2 clade, 1 of 2 Af/Eur clade, and 0 of 21 deletions clade, would have a breadth of 0.625.
   - `antibody_escapability` is the sum of all per-mut escape fractions for an antibody, removing any mutation that is less than 5x the global median escape fraction across all antibody selections in the Vir set. In the script, I tried other things such as normalizing by median, or censoring out <5x median with median computed specific to each antibody, but these antibody-specific normalizations or censorings (especially normalizations) created considerable bias between selections that had more or less background in the escape fractions (e.g. compare S2X259 and S2X35 line plots in the escape profiles/logoplots). I liked this global-median-censored metric because it basically is summing just the "real" "big" escape muts, rather than letting pervasive differences in the values of small ("background") muts drive large differences in sums. This is essentially an arbitrary units value (as are the two below), and we can probably just rescale each to be from zero to 1 as a relative metric.
   - `antibody_escapability_tolerance_weighted` is similar to the `antibody_escapability` metric above, but multiplies each `mut_escape_frac` by 0-to-1 scalars for mut effects on RBD expression and ACE2 binding, such that mutations with one or both of these scores being more deletious are down-weighted in the summing of mut scores. Specifically, I rescaled each of the DMS measurements of RBD expression and ACE2 binding such that any value lower than -1 gets a raw scalar of 0, and any DMS measurement of 0 or greater gets a raw scalar of 1. The rationale for the -1 imposition even on the ACE2 binding score, where we normally allow more leniency, is that in VSV escape selections, natural variants, etc., we rarely see mutations with more ACE2 binding deficit than -0.5. Finally, not really sure why, but I took these raw 0 to 1 scalars for each DMS metric, and squared it to derive the final multiplication factors to multiply by `mut_escape_frac`, censoring out `mut_escape_frac` of <5x median as above. The rationale for this squaring is that it further penalizes more detrimental DMS scores. The per-antibody sum is then each mutation escape frac multiplied by the separate RBD and ACE2 scalars (so if either or both DMS scalar is zero, for example, the mutation is not an "escape" mutation and contributes zero to this tolerance-weighted escapability).
   - `antibody_escapability_natural_variation_weighted` is similar to the `antibody_escapability` metric above, but multiplies each `mut_escape_frac` by 0-to-1 scalar reflecting the mutation's prevalence on sequences in GISAID (as of 12/25/2020), such that mutations that are observed less frequently in circulating variants are down-weighted in the summing of per-mut scores for the summary escapability metric. Specifically, I took the log10-frequency of a variant on GISAID (with mutations with zero observations set to a pseudo-frequency of 0.1x the frequency of a singe-count amino acid), and rescaled the range of log10-pseudofrequency values to be from 0 to 1. Then, above, I included this scalar as a multiplication factor for each `mut_escape_frac` before summing mutations (once again, censoring out mutations with escape fracs <5x the global median).